### 1.概念

* grid 网格
* block 线程块

* 线程分块是逻辑划分
* 配置线程

```c++
<<<grid_size, block_size>>>
```

* 最大允许线程块大小 1024
* 最大允许网格大小（一维）$2^{31}-1$

### 2.一维线程模型

>每个线程在核函数中都有唯一身份标识

每个线程的唯一标识由<<<grid_size, block_size>>>组成

* gridDim.x = grid_size
* blockDim.x = block_size

线程索引也是内建变量

* blockIdx.x : 0~gridDim.x-1
* threadIdx.x : 0~blockDim.x-1

* Idx = threadIdx.x + blockIdx.x * blockDim.x

### 3.多维线程模型

blockIdx和threadIdx都是uint3变量，结构体包括x,y,z三个成员

* blockIdx.x .y .z

定义多维网格和线程块

``` c++
dim3 grid_size(3,2,1);
dim3 block_size(5,3,1);
```

### 4.线程全局索引计算方式

**2维**

```c++
int blockId = blockIdx.x + blockIdx.y * gridDim.x
int threadId = threadIdx.x + threadIdx.y * blockDim.x
```

**3维**

```c++
int blockId = blockIdx.x + blockIdx.y * gridDim.x + blockIdx.z * gridDim.x * gridDix.y
int threadId = threadIdx.x + threadIdx.y * blockDim.x + blockIdx.z * blockDim.x * blockDim.y
```
